# Ch14. 가상화 기술

---

**Contents**

14.1 장비 가상화 기술이란?

14.2 벤더별 장비 가상화 기술: 하나의 논리 장비로 만드는 가상화

14.3 벤더별 장비 가상화 기술: 여러 개의 논리 장비로 만드는 가상화

---

# 14.1 장비 가상화 기술이란?

- **가상화는 리소스의 추상화**

- 장비 가상화 기술의 분류
    1. **여러 개의 물리 장비를 하나의 논리 장비로 합치는 기술**
    2. **하나의 물리 장비를 여러 개의 논리 장비로 나누는 기술**

<img width="729" alt="NW_14-1" src="https://github.com/aivle33-dev-study/cs-study/assets/90406411/27b8e249-2822-4e79-8717-73569e867377">

하나의 논리 장비로 구성 or 여러 개의 논리 장비를 구성하는 가상화 기술

### 1. 여러 대의 물리 장비를 하나의 논리 장비로 합치는 기술

- 장점
    - **다수의 장비를 하나의 장비처럼 관리할 수 있어 운영자의 관리부하를 줄여줌**
    - **이중화 경로를 효율적으로 사용하고 루프 문제를 제거할 수 있음**
        
        여러 대의 물리 장비를 하나의 논리 장비로 구성한 스위치는 2계층의 이중화 경로에서 루프 구조를 제거하면서 전체 경로를 모두 사용할 수 있어 물리적 경로를 모두 활용할 수 있음
        

c.f. 인터페이스 가상화 기술 LACP와 MC-LAG

서버와 스위치의 물리 인터페이스를 하나의 논리 인터페이스로 구성해주는 **LACP와 MC-LAG**가 가상화 기술 범주에 포함

### 2. 하나의 물리 장비를 여러 개의 논리 장비로 나누는 기술

- VLAN도 속하지만 대표적 가상화 기술은 VMware의 ESXi와 같이 하나의 **물리 서버에 여러 개의 가상 서버를 구성하는 서버 가상화 기술**
- 네트워크 장비에서도 서버 가상화처럼 하나의 물리 장비를 여러 개의 논리 장비로 나눌 수 있음
- 하이퍼바이저를 이용한 가상화 형태로 나누거나 벤더 자체 솔루션을 이용해 나눔

- 가상화를 통해 나뉜 장비는 **하나의 물리적 리소스를 공용으로 사용하는 경우**도 있지만 각 **논리 장비마다 리소스를 독립적으로 할당**해 서로 다른 논리 장비 간에는 리소스 사용을 침범하지 않게 해 논리 장비 간에 영향을 미치지 않도록 구성

<img width="641" alt="NW_14-5" src="https://github.com/aivle33-dev-study/cs-study/assets/90406411/d5a518e3-ad5e-4c6f-a90b-09c29fd9f7a6">

가상화한 장비 간의 리소스를 독립적으로 할당

- 이렇게 여러 대로 가상화된 장비는 데이터 센터 내 장비를 영역별로 나눌 때 사용할 수 있음

- 장점
    - **운용 시 관리 포인트 감소**
        
        각 서비스 영역에 대해서는 개별적으로 동작하더라도 운영 면에서는 **하나의 장비로 관리**할 수 있어 관리부하를 줄임
        
    - **자원활용률 증가**
        
        서버 가상화처럼 **기존 유휴자원을 다른 영역에서 나누어 사용**하게 함으로써 네트워크 장비의 자원을 효율적으로 사용할 수 있음
        
    - **도입비용과 운영비용 절감(Capex & Opex)**
        
        물리 장비 대신 논리 장비로 구성하면서 전체 장비 물량이 줄어 도입비용과 운용비용이 절감
        

- 장비 가상화를 이용해 이중화 구성을 하더라도 물리 장비 **하나에서 동일한 역할을 논리적으로 나누어 사용하지 않음**
- 논리적으로 구성된 장비가 물리 리소스를 독립적으로 할당해 사용하더라도 **물리 장비에 장애가 발생하면 논리 장비 모두 서비스의 영향을 받으므로** **동일한 역할을 하는 장비의 이중화 구성을 하나의 물리 장비에서 구성하면 안됨**

- 가상화할 때의 유의사항
    - 여러 영역에 들어갈 장비를 하나의 물리 장비에서 논리적으로 나누려면 **각 영역이 요구하는 성능을 물리 장비에서 제공할 수 있어야함**
    - 기능 면에서도 물리 장비에서 제공되는 기능이 논리적으로 가상화한 경우에도 정상적으로 제공되는지 확인

- 물리 장비를 논리 장비로 나누는 가상화를 도입하면 CAPEX와 OPEX 모두 효과적으로 줄일 수 있음
- 하지만 가상화를 무작정 시도하면 문제가 발생했을 때 손실비용이 더 커질 수 있음

c.f. CAPEX, OPEX

**CAPEX(CAPital Expenditures)**

: 장비 도입비용

**OPEX(OPeration EXpenditures)**

: 운영비용

# 14.2 벤더별 장비 가상화 기술: 하나의 논리 장비로 만드는 가상화

## 14.2.1 시스코 시스템즈의 가상화 기술

### 1. **VSS**

- **VSS(Virtual Switching System)는 VSL(Virtual Switching Link)로 장비를 연결해 하나의 가상 스위치를 만듦**
- VSS를 통해 최대 두 대의 물리 장비를 한 대의 가상 스위치로 구성할 수 있음
- VSS는 시스템에서 운영할 수 있는 대역폭을 확장하고 가용성을 증대시킴

<img width="726" alt="NW_14-9" src="https://github.com/aivle33-dev-study/cs-study/assets/90406411/341d2197-22be-4e9c-b63c-9001123578fd">

시스코 VSS를 사용하면 두 대의 물리 장비를 하나의 논리 장비로 구성할 수 있다 

### 2. **StackWise/FlexStack**

- StackWise와 동일한 FlexStack이라는 가상화 기술도 존재
- VSS는 최대 두 대의 장비를 하나의 가상 스위치로 구성하지만 지원되는 **StackWise나 FlexStack은 최대 8~9대의 스위치를 하나의 가상 스위치로 구성할 수 있음**
- StackWise나 FlexStack과 같은 스택 구성은 일반 포트를 사용하지 않고 **스위치 후면에 있는 별도 스택 구성용 모듈이나 케이블을 사용해 데이지 체인(Daisy Chain) 형태로 구성**
- 장비 간 통신을 위한 데이터 케이블뿐만 아니라 경우에 따라 전원도 동일한 방식으로 구성

<img width="816" alt="NW_14-10" src="https://github.com/aivle33-dev-study/cs-study/assets/90406411/89d4bff6-da12-4a63-812a-68e2bb1fa650">

시스코 StackWise를 사용하면 여러 개의 스위치를 하나의 새시형 장비처럼 구성할 수 있다

### 3. **FEX**

- **하나의 스위치를 다른 장비의 모듈 형태로 구성하는 FEX(Fabric Extender) 기술**
- FEX는 하나의 스위치가 다른 스위치의 모듈 형태로 구성되는 구조이며 FEX 장비에는 별도의 운영체제가 없고 상단 스위치의 운영체제 그대로 사용
- FEX는 ToR와 같은 용도로 사용하면 각 랙 서버들은 상단 FEX와 연결되지만 관리는 상단 스위치에서만 하면 됨

<img width="810" alt="NW_14-12" src="https://github.com/aivle33-dev-study/cs-study/assets/90406411/0c214776-c81d-4cc0-8d8b-4a556b9411d5">

FEX의 물리적 구조와 논리적 구조

## 14.2.2 주니퍼

### 1. **가상 섀시**

- **여러 개의 스위치를 링(Ring) 형태의 토폴로지로 연결해 하나의 장비처럼 관리할 수 있음**
- **최대 10대의 장비**를 스택으로 구성할 수 있음
- 가상 섀시는 장비 간 연결을 위해 VCP(Virtual Chassis Port) 전용 포트를 사용하는 모델도 있지만 VCP 포트가 없으면 일반 업링크(Uplink) 포트를 사용해 장비를 연결할 수 있음

### 2. **VCF**

- **VCF(Virtual Chassis Fabric, 가상 섀시 패브릭)는 여러 개의 물리 스위치를 하나의 가상 섀시 패브릭 장비로 구성**
- 스파인-리프 형태로 디자인하고 스파인은 2~4대를 포함해 최대 20대의 장비를 패브릭 멤버로 구성할 수 있음
- VCF는 16개 랙 규모의 PoD(Point of Delivery) 사이즈에 적합

### 3. **주노스 퓨전**

- 주노스 퓨전(Junos Fusion)은 VCF보다 대규모에 적용
- 주노스 퓨전은 유형에 따라 3가지 아키텍처로 나뉨
    - Junos Fusion Provider Edge
    - Junos Fusion Data Center
    - Junos Fusion Enterprise

## 14.2.3 익스트림(Extreme)

- 익스트림에는 **여러 개의 스위치를 하나의 클러스터 형태의 가상 스위치로 구성하는 VCS(Virtual Cluster Switching)**라는 가상화 기술이 있음
- VCS 클러스터로 구성된 스위치는 별다른 설정 없이 **스위치간 ISL(Inter-Switch Link)을 구성하는 것만으로 VCS 클러스터에 자동으로 묶이므로** 네트워크 스위치의 손쉬운 **스케일 아웃(Scale-out)을 지원**

## 14.2.4 HP 엔터프라이즈(HP Networking)

- HP 네트워크에는 **IRF(Inteligent Resilient Fabric)**라는 스위치 가상화 기술 존재
    
    → 여러 대의 스위치를 하나의 가상 스위치로 구성
    
- 가상화 네트워크 확장(Enhanced IRF) 기술을 사용하면 다른 계층과 다른 모델 스위치도 하나의 논리적 스위치로 구성할 수 있음

# 14.3 벤더별 장비 가상화 기술: 여러 개의 논리 장비로 만드는 가상화

## 14.3.1 시스코 시스템즈

- 시스코 시스템즈에서는 **VDC(Virtual Device Context) 기능으로 하나의 물리 스위치를 최대 8개의 논리 스위치로 나누어 사용할 수 있음**
- VDC 별로 독립적인 설정(Configuration)과 소프트웨어 프로세스가 동작하며 전체 리소스를 VDC별로 분할해 사용
- 각 VDC에 별도로 권한을 부여해 관리할 수 있고 가상으로 나눈 VDC마다 관리자를 부여할 수도 있음
- 물론 전체 VDC를 관리할 수 있는 별도의 관리 VDC(Admin VDC)도 지원하여 전체 총괄 관리자도 함께 둘 수 있음

<img width="726" alt="NW_14-15" src="https://github.com/aivle33-dev-study/cs-study/assets/90406411/91c76b8d-27af-48ef-9f30-04e7a77bf300">

시스코 시스템즈의 VDC

## 14.3.2 시트릭스

- 시트릭스(Citri)에는 MPX와 VPX가 존재
- MPX는 기존 일반 하드웨어로 제공되는 제품군이며 VPX는 소프트웨어로 제공되는 제품군
- SDX 제품군이 있는데 하이퍼바이저인 Xen이 설치된 하드웨어 박스
- SDX 제품군에 소프트웨어로 제공되는 VPX를 설치해 하나의 물리 박스의 L4/L7 스위치를 여러 개의 가상 논리 L4/L7로 구성해 사용할 수 있는 멀티 테넌트 플랫폼을 제공할 수 있음
- 테넌트별로 분리된 L4/L7스위치 인스턴스는 메모리, CPU, SSL을 독립적으로 운영할 수 있으며 버전도 독립적으로 구성
- SDX를 전체적으로 관리할 수 있는 SVM(Service Virtual Machine)이 있음

<img width="553" alt="NW_14-16" src="https://github.com/aivle33-dev-study/cs-study/assets/90406411/a10c66cf-c2fb-4a68-9945-24c227303fd6">

시트릭스의 SDX(VPX)

## 14.3.3 F5

- F5 제품군은 vCMP(Virtual Clustered Multi Processing) 가상화 기술을 지원
- vCMP를 사용해 나누어지는 개별 가사오하 장비를 Guest라고 하며 각 Guest 장비에는 개별적으로 CPU 코어를 할당할 수 있고 할당된 CPU 자원을 독립적으로 사용 가능
- 해당 자원은 가상화 장비 간에 독립적으로 동작해 특정 가상화 장비의 사용량이 늘어도 다른 가상화 장비에 영향 없음
- 또한 개별적으로 동작해 가상화 장비 간에 다른 버전의 운영체제 사용 가능

<img width="725" alt="NW_14-17" src="https://github.com/aivle33-dev-study/cs-study/assets/90406411/165ab014-ab4b-4c8b-b0db-03eba1692322">

f5 vCMP

## 14.3.4 포티넷

- 포티넷(Fortinet)의 포티게이트(Fortigate)제품군에서는 VDOM 가상화 기술을 사용해 물리 장비를 여러 대의 논리 장비로 나눌 수 있음
- VDOM은 Virtual Domain의 약자로 최근 네트워크 가상화에서 유행하는 전 가상화 시스템과 과거부터 많이 사용해온 VRF(Virtual Routing and Forwarding)의 중간 수준의 가상화 기능을 제공
- 일반 네트워크장비는 VRF를 이용해 라우팅을 분리하는 것만으로도 다양한 효과를 얻음
- 하지만 방화벽은 일반 네트워크 장비와 달리 네트워크 부분과 정책 관리 및 적용 부분으로 나누어져 있어 라우팅 분리만으로는 부족
- VDOM은 라우팅뿐만 아니라 정책 단위로 시스템 전체를 가상화

<img width="374" alt="NW_14-18" src="https://github.com/aivle33-dev-study/cs-study/assets/90406411/53721d96-b675-4d8b-b8e9-dffbe68325f8">

포티넷의 VDOM
