# Ch12. 프로세스 동기화

&nbsp;
## 12-1. 동기화

    keywords : 동기화, 공유 자원, 임계 구역, 상호 배제
<br>

시작하기 전에,

동시다발적으로 실행되는 프로세스들은 공동의 목적을 올바르게 수행하기 위해 서로 협력하며 영향을 주고받기도 합니다. 

이렇게 협력하여 실행되는 프로세스들은 실행 순서와 자원의 일관성을 보장해야 하기에 반드시 `동기화(synchronization)` 되어야 합니다.
<br><br>

### ● 동기화의 의미

- **동기화**
    
    특정 자원에 접근할 때 한 개의 프로세스만 접근하게 하거나 프로세스를 올바른 순서대로 실행하는 것
    
    프로세스들의 수행 시기를 맞추는 것
    <br>
    
- 동기화의 종류
    - 실행 순서 제어 : 프로세스를 올바른 순서대로 실행하기
    - 상호 배제 : 동시에 접근해서는 안 되는 자원에 하나의 프로세스만 접근하게 하기
    
    - cf. 스레드도 동기화의 대상임! 정확히 말하면, 실행 흐름을 갖는 모든 것은 동기화의 대상임
    <br>

- **실행 순서 제어를 위한 동기화**
    - Writer 프로세스와 Reader 프로세스가 동시에 실행중이라고 가정,
    
        Writer 프로세스가 값을 저장하기도 전에 Reader 프로세스가 실행되면 안되기 때문에 두 프로세스의 실행 순서는 제어되어야 함
        
- **상호 배제를 위한 동기화**
    - 동시에 접근해서는 안되는 자원에 동시에 접근하지 못하게 하는 것
    
    - 상호 배제를 위한 동기화에 필요한 세가지 원칙
        
        - **상호 배제 (mutual exclusion)**

            - 한 프로세스가 임계 구역에 진입했다면 다른 프로세스는 임계 구역에 들어올 수 없음
        
        - **진행 (progress)**

            - 임계 구역에 어떤 프로세스도 진입하지 않았다면 임계 구역에 진입하고자 하는 프로세스는 들어갈 수 있어야 함
        
        - **유한 대기 (bounded waiting)**

            - 한 프로세스가 임계 구역에 진입하고 싶다면 그 프로세스는 언젠가는 임계 구역에 들어올 수 있어야 함
            <br>

- **공유자원**

    - 여러 프로세스/ 스레드가 공동으로 사용하는 자원
    e.g. 전역 변수, 파일, 입출력장치, 보조기억장치

- **임계 구역 (critical section)**

    - 공유 자원에 접근하는 코드 중 동시에 실행하면 문제가 발생하는 코드 영역

    - 임계 구역에 진입한 프로세스가 있다면 다른 프로세스는 임계 구역 밖에서 기다려야 함

- **레이스 컨디션**
    - 잘못된 실행으로 인해 여러 프로세스가 동시 다발적으로 임계 구역의 코드를 실행하여 문제가 발생하는 경우


&nbsp;
## 12-2. 동기화 기법

    ☑️ keywords : 뮤텍스 락, 세마포, 모니터
<br>

### ● 뮤텍스 락 (Mutex lock : MUTual EXclusion lock)

- 동시에 접근해서는 안되는 자원에 동시에 접근하지 않도록 만드는 도구

- 상호 배제를 위한 동기화 도구

- 뮤텍스 락은 하나의 전역 변수와 두 개의 함수로 구현 가능

    - 프로세스들이 공유하는 전역 변수 : 자물쇠 역할

    - acquire 함수 : 임계 구역을 잠그는 역할

        - acquire 함수

            - 프로세스가 임계 구역에 진입하기 전에 호출하는 함수

            - 임계 구역을 반복적으로 확인하고 (바쁜 대기), 임계 구역이 열려 있다면 임계 구역을 잠그는(lock → true) 함수

    - release 함수 : 임계 구역의 잠금을 해제하는 역할

        - 임계 구역에서 작업이 끝나고 호출하는 함수

        - 현재 잠긴 임계 구역을 열어주는(lock → false) 함수


- cf. C/C++, python 등의 일부 프로그래밍 언어에서는 사용자가 직접 acquire, release 함수를 구현하지 않도록 뮤텍스 락 기능을 제공
<br>

### ● 세마포 (semaphore)

- 뮤텍스 락과 비슷하지만 일반화된 방식의 동기화 도구

- 하나의 공유 자원에 접근하는 프로세스를 상정한 방식

- 공유 자원이 여러 개 있는 임계 구역 문제도 해결할 수 있는 동기화 도구

- cf. 엄밀히 따지면 이진 세마포, 카운팅 세마포가 있지만, 이진 세마포는 뮤텍스 락과 비슷한 개념이므로 여기서는 여러 공유 자원을 다룰 수 있는 카운팅 세마포를 다룸
<br>

### ● 모니터 (monitor)

- 세마포에 비해 사용자가 사용하기 편리한 동기화 도구로 조건 변수 사용

- 공유 자원과 공유 자원에 접근하기 위한 인터페이스(통로)를 묶어서 관리함

- 프로세스는 반드시 인터페이스를 통해서만 공유 자원에 접근하도록 함

- 실행 순서를 제어하기 위한 동기화 제공

- 특정 조건을 바탕으로 프로세스를 실행하고 일시 중단하기 위해 조건변수 사용

    - 조건변수 : 프로세스나 스레드의 실행 순서를 제어하기 위해 사용하는 특별한 변수
