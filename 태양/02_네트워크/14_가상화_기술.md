## Chapter 14 가상화 기술

### Chapter 14.1 장비 가상화 기술이란?

가상화는 리소스의 추상화를 말한다. 장비 가상화 기술은 다음 두 가지로 크게 분류할 수 있다.

- 여러 개의 물리 장비를 하나의 논리 장비로 합치는 기술
- 하나의 물리 장비를 여러 개의 논리 장비로 나누는 기술

이와 같은 기술은 두 가지 장점이 있다.

1. 다수의 장비를 하나의 장비처럼 관리할 수 있어 운영자의 관리부하를 줄여준다.
2. 이중화 경로를 효율적으로 사용하고 루프 문제를 제거할 수 있다.

여러 대의 물리 장비를 하나의 논리 장비로 다루는 기술이 있다면 반대로 큰 장비를 나누어 사용할 수도 있다. 즉 하나의 물리 장비를 여러개의 논리 장비로 나누는 기술이다.

\*\* 기대 효과 \*\*

- 운용 시 관리 포인트 감소
각 서비스 영역에 대해서는 개별적으로 동작하더라도 운영 면에서는 하나의 장비로 관리할 수 있어 관리부하를 줄일 수 있다.

- 자원활용률 증가
서버 가상화처럼 기존 유휴자원을 다른 영역에서 나누어 사용하게 함으로써 네트워크 장비의 자원을 효율적으로 사용할 수 있게 됩니다.

- 도입비용과 운영비용 절감(Capex & Opex)
물리 장비 대신 논리 장비로 구성하면서 전체 장비 물량이 줄어 도입비용과 운용비용이 절감된다.

\*\* 유의 사항 \*\*

여러 영역에 들어갈 장비를 하나의 물리 장비에서 논리적으로 나누려면 각 영역이 요구하는 성능을 물리 장비에서 제공할 수 있어야 합니다. 
특히 물리 장비에서 제공하는 성능을 가상화로 나누면 '전체 용량/가상화 수'에 정확히 맞추어 성능이 나누어지는 것이 아니라 성능이 저하되는 부분이 있으므로 용량 산정에 더 신경써야 한다. 또한, 방화벽이나 L4/L7 스위치와 같이 하나의 물리 장비에서 제공되는 인터페이스가 많지 않은 경우에는 인터페이스 수도 고려해야한다.

기능 면에서도 물리 장비에서 제공되는 기능이 논리적으로 가상화한 경우에도 정상적으로 제공되는지 확인해야 한다.


### Chapter 14.2 벤더별 장비 가상화 기술: 하나의 논리 장비로 만드는 가상화

#### 14.2.1 시스코 시스템즈의 가상화 기술
##### 14.2.1.1 VSS
VSS는 VSL로 장비를 연결해 하나의 가상 스위치를 만든다. VSS 기술은 Cisco Catalyst 6500/6800과 Cisco Catalyst 4500 제품군에서 지원되며 VSS를 통해 최대 두 대의 물리 장비를 한 대의 가상 스위치로 구성할 수 있다.

VSS는 시스템에서 운영할 수 있는 대역폭을 확장하고 가용성을 증대시킨다.

##### 14.2.1.2 StackWise/FlexStack
VSS는 최대 두 대의 장비를 하나의 가상 스위치로 구성할 수 있지만 지원되는 StackWise나 FlexStack는 최대 8~9대의 스위치를 하나의 가상 스위치로 구성할 수 있습니다.

StackWise나 FlexStack와 같은 스택 구성은 일반 포트를 사용하지 않고 스위치 후면에 있는 별도 스택 구성용 모듈이나 케이블을 사용해 데이지 체인 형태로 구성합니다. 장비 간 통신을 위한 데이터 케이블뿐만 아니라 경우에 따라 전원도 동일한 방식으로 구성한다.

##### 14.2.1.3 FEX
VSS나 Stack과 같은 기술이 동일한 장비를 하나의 가상 장비로 한다면 하나의 스위치를 다른 장비의 모듈 형태로 구성하는 FEX 기술이 있습니다.

FEX는 하나의 스위치가 다른 스위치의 모듈 형태로 구성되는 구조이며 FEX 장비에는 별도의 운영체제가 없고 상단 스위치의 운영체제 그대로 사용합니다.

#### 14.2.2 주니퍼
주니퍼에서도 여러 개의 물리 장비를 하나의 논리적 장비로 만드는 몇 가지 기술을 제공한다.

##### 14.2.2.1 가상 새시
EX와 QFX 시리즈 스위치에서 지원되는 가상화 기술이다. 여러 개의 스위치를 링 형태의 토폴로지로 연결해 하나의 장비처럼 관리할 수 있다.

##### 14.2.2.2 VCF
가상 새시와 마찬가지로 EX와 QFX 시리즈 스위치에서 지원되는 가상화 기술이다. VCF는 여러 개의 물리 스위치를 하나의 가상 새시 패브릭 장비로 구성한다. 스파인-리프 형태로 디자인하고 스파인은 2~4대를 포함해 최대 20대의 장비를 패브릭 멤버로 구성할 수 있습니다. VCF는 16개 랙 규모의 PoD 사이즈에 적합합니다.

##### 14.2.2.3 주노스 퓨전
VCF보다 대규모에 적용할 수 있다. 유형에 따라 3가지 아키텍처로 나뉘며 각 기술에 따라 지원되는 장비 모델이 다릅니다.
- Junos Fusion Provider Edge
- Junos Fusion Data Center
- Junos Fusion Enterprise

#### 14.2.3 익스트림
여러 개의 스위치를 하나의 클러스터 형태의 가상 스위치로 구성하는 VCS라는 가상화 기술이 있습니다.
하나의 클러스터로 구성되는 VCS 로지컬 새시는 최대 48개의 브로케이드 VCS 패브릭을 한 대의 가상 스위치로 만들어 관리할 수 있습니다.

VCS 클러스터로 구성된 스위치 장비는 별다른 설정 없이 단순히 스위치 간 ISL을 구성하는 것만으로 VCS 클러스터에 자동으로 묶이므로 네트워크 스위치의 손쉬운 스케일 아웃을 지원합니다. 물론 아무 설정 없이 연결해도 구성에는 문제가 없지만 관리상 편의를 위해 VCS 내에서 사용되는 ID 값은 관리자가 직접 설정해주는 것이 좋습니다.

#### 14.2.4 HP 엔터프라이즈
HP 네트워크에는 IRF라는 스위치 가상화 기술이 있습니다. 앞에서 다루었듯이 여러 대의 스위치를 하나의 가상 스위치로 구성할 수 있습니다. 다른 벤더가 하나의 가상 스위치로 구성할 수 있는 제품이 제한적인 반면, HR IRF는 모든 제품에서 스위치 가상화를 지원하고 있습니다. 다만 IRF로 구성할 때는 동일한 모델끼리 구성해야 합니다.

### Chapter 14.3 벤더별 장비 가상화 기술: 여러 개의 논리 장비로 만드는 가상화

하나의 물리 장비를 여러 개의 논리 장비로 나누는 각 벤더별 기술을 살펴보자.

#### 14.3.1 시스코 시스템즈
시스코 시스템즈에서는 데이터 센터 스위치인 Nexus 7000/7700 제품군에서 VDC 기능으로 하나의 물리 스위치를 최대 8개의 논리 스위치로 나누어 사용할 수 있습니다.

#### 14.3.2 시트릭스
시트릭스의 L4/L7 NetCaler 제품군에는 MPX와 VPX가 있습니다. MPX는 기존 일반 하드웨어로 제공되는 제품군이며 VPX는 소프트웨어로 제공되는 제품군입니다.

#### 14.3.3 F5
F5 제품군은 vCMP 가상화 기술을 지원합니다. vCMP는 F5 제품군 중 모델명이 'v'로 끝나는 시리즈이거나 i5800 이상인 모델에서는 기본적으로 지원합니다.

vCMP을 사용해 나누어지는 개별 가상화 장비를 Guest라고 하며 각 Guest 장비에는 개별적으로 CPU 코어를 할당할 수 있고 할당된 CPU 자원을 독립적으로 사용할 수 있습니다.

#### 14.3.4 포티넷
포티넷의 포티게이트 제품군에서는 VDOM 가상화 기술을 사용해 물리 장비를 여러 대의 논리 장비로 나눌 수 있습니다. 두 개의 클러스터를 이용해 이런 논리적 VDOM을 그룹화해 관리할 수 있습니다.

VODM은 Virtual Domain의 약자로 최근 네트워크 가상화에서 유행하는 전 가상화 시스템과 과거부터 많이 사용해온 VRF의 중간 수준의 가상화 기능을 제공합니다.